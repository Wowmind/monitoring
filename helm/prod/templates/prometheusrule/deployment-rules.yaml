{{- if and .Values.prometheusRules (eq .Values.prometheusRules.enabled true) .Values.deployment.enabled }}

apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: {{ include "fullname" . }}-deployment-alerts
  namespace: monitoring
  labels:
    release: prometheus
spec:
  groups:
  - name: deployment.rules
    rules:
    {{- range .Values.deployment.alerts }}
      - alert: {{ .name }}
        expr: {{ .expr | quote }}
        for: {{ .for }}
        labels:
          severity: {{ .severity }}
        annotations:
          summary: {{ .summary | quote }}
          description: {{ .description | quote }}
          impact: {{ .impact | quote }}
          action: {{ .action | quote }}
    {{- end }}
{{- end }}
